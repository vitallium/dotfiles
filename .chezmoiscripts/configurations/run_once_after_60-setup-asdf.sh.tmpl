#!/usr/bin/env bash

# ask sudo upfront
sudo -v

set -eufo pipefail

# Ruby
sudo dnf install -y gcc make bzip2 openssl-devel \
                    libyaml-devel libffi-devel readline-devel \
                    zlib-devel gdbm-devel ncurses-devel \
                    libcurl-devel uuid-devel libuuid-devel \
                    sqlite sqlite-devel tk-devel xz-devel \
                    m4 ncurses-devel autoconf

# TODO: Instead of deleting the asdf we need to check if the directory exists and update asdf version
rm -rf ~/.asdf
git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.10.2

# reload shell before installing asdf plugins
. "$HOME/.asdf/asdf.sh"

ASDF_PLUGINS=(
  direnv
  elixir
  erlang
  golang
  minio
  nodejs
  postgres
  python
  redis
  ruby
  yarn)

for i in "${ASDF_PLUGINS[@]}"; do
  asdf plugin add "$i"
done

asdf install direnv latest
